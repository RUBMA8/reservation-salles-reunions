<div class="user-section">
  <h1>Mes RÃ©servations</h1>

  <div class="reservations-list">
    {{#each reservations}}
    <div class="reservation-card">
      <p class="statut statut-{{statut}}">
        {{#ifEquals statut 'active'}}
         Active
        {{/ifEquals}}
        {{#ifEquals statut 'annulee'}}
        AnnulÃ©e
        {{/ifEquals}}
      </p>
      <h3>ğŸ¢ {{salle_nom}}</h3>
      <p>ğŸ“… <strong>DÃ©but:</strong> {{formatDate date_debut}}</p>
      <p>ğŸ“… <strong>Fin:</strong> {{formatDate date_fin}}</p>
      {{#if motif}}
      <p><strong>Motif:</strong> {{motif}}</p>
      {{/if}}
      <p>ğŸ‘¥ <strong>CapacitÃ©:</strong> {{capacite}} personnes</p>


      {{#ifEquals statut 'active'}}
      <button onclick="cancelReservation({{id}})" class="btn btn-danger btn-sm mt-20">
        Annuler 
      </button>
      {{/ifEquals}}
    </div>
    {{else}}
    <div class="alert alert-warning">
      <p>Vous n'avez pas encore de rÃ©servation.</p>
      <a href="/salles" class="btn btn-primary mt-20">ğŸ“… RÃ©server une salle</a>
    </div>
    {{/each}}
  </div>
</div>

<script>
  async function cancelReservation(id) {
    if (!confirm('ÃŠtes-vous sÃ»r de vouloir annuler cette rÃ©servation ?')) {
      return;
    }

    try {
      const response = await fetch(`/reservations/${id}`, {
        method: 'DELETE',
        headers: {
          'Accept': 'application/json'
        }
      });

      if (response.ok) {
        alert('âœ… RÃ©servation annulÃ©e!');
        window.location.reload();
      } else {
        const result = await response.json();
        alert('âŒ ' + result.error);
      }
    } catch (error) {
      alert('âŒ Erreur: ' + error.message);
    }
  }
</script>
